import random
import numpy as np
from rlcard.agents.best_response_agent import BRAgent


def exploitability(env, policy):
    state, player_id = env.init_game()
    num_players = env.player_num
    if num_players != 2:
        raise "Not two-players game"
    agents = [BRAgent(env, policy), BRAgent(env, policy)]
    value_sum = 0
    for idx, best_responder in enumerate(agents):
        state = env.get_state(player_id)
        val = best_responder.value(player_id, state, idx)
        print("Val:", val)
